var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,i=(e,t)=>{for(var a in t||(t={}))n.call(t,a)&&r(e,a,t[a]);if(s)for(var a of s(t))o.call(t,a)&&r(e,a,t[a]);return e},c=(e,s)=>t(e,a(s));import{d,a as p,w as l,o as m,e as u,n as f,r as h,l as g,m as v,B as b,O as y,u as x,f as j,y as O,E as w,G as k}from"./@vue.0069b3ae.js";import{u as S}from"./vuex.cf57797f.js";import{u as I}from"./vue-router.8c9b9931.js";import{i as P}from"./index.c89e9310.js";import{l as _,r as A}from"./index.b27fe81c.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import{G as C}from"./index.3a5a0fca.js";import"./vuex-persistedstate.fa252374.js";import"./axios.e7b69eb3.js";const U=["width","height"];var N=B(d(c(i({},{name:"g-code"}),{props:{w:{default:320},h:{default:150},num:{default:"1000"}},setup(e){const t=e,a=p();l((()=>t.num),((e,t)=>{f((()=>{s()}))}),{deep:!0,immediate:!0});const s=()=>{var e=a.value,s=e.getContext("2d");s.clearRect(0,0,e.width,e.height);const n=e.height/2;s.font=n+"px bold 黑体",s.fillStyle="#fff",s.textAlign="center",s.textBaseline="middle",s.fillText(t.num,e.width/2,e.height/2)};return(e,s)=>(m(),u("canvas",{ref_key:"loginCheckout",ref:a,width:t.w,height:t.h},"当前浏览器不支持canvas，请更换浏览器后再试",8,U))}})),[["__scopeId","data-v-2c5d53cc"]]);const G=e=>(w("data-v-e2a11210"),e=e(),k(),e),J={class:"contanir theme"},V=G((()=>v("div",{class:"login-title"},"LOGIN",-1))),E={class:"form-input"},M=G((()=>v("span",null,"账 号：",-1))),D={class:"form-input"},L=G((()=>v("span",null,"密 码：",-1))),R={class:"form-input code"};var T=B(d(c(i({},{name:"login"}),{setup(e){const t=S(),a=I(),s=h({num:"",name:"admin",pass:"admin",code:""}),n=/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent);t.dispatch("setBaseAction",{isPc:!n}),g((()=>{}));const o=()=>{s.num=Math.floor(9e3*Math.random()+1e3),s.code=s.num};o();const r=()=>s.name?s.pass?s.code.toString()===s.num.toString()||"验证码不一致":"密码不能为空":"账号不能为空",i=()=>{if(!0!==r())return C({message:r(),type:"error",duration:1500}),!1;if(n){const e={name:s.name,pass:s.pass};_(e).then((e=>{C({message:"登录成功",type:"success",duration:2e3});const n=e.data[0];t.dispatch("setUserAction",{name:s.name,avator:n.avator,userId:n.Id}),P(),sessionStorage.setItem("token",JSON.stringify(e.token)),a.push("/chat")})).catch((e=>{C({message:"登录失败："+e.message,type:"error",duration:2e3})}))}else t.dispatch("setUserAction",{name:"admin",avator:"",userId:0}),sessionStorage.setItem("token","is-token"),a.push("/index")},c=()=>{const e={name:s.name,pass:s.pass};A(JSON.parse(JSON.stringify(e))).then((e=>{C({message:e.message,type:"success",duration:2e3})})).catch((e=>{C({message:"注册失败："+e.message,type:"error",duration:2e3})}))};return(e,a)=>(m(),u("div",J,[v("div",{class:O(["box",{"box-mobile":!x(t).getters.base.isPc}])},[V,v("div",E,[M,b(v("input",{type:"text",placeholder:"账号：admin","onUpdate:modelValue":a[0]||(a[0]=e=>x(s).name=e)},null,512),[[y,x(s).name]])]),v("div",D,[L,b(v("input",{type:"password",placeholder:"密码：admin","onUpdate:modelValue":a[1]||(a[1]=e=>x(s).pass=e)},null,512),[[y,x(s).pass]])]),v("div",R,[b(v("input",{type:"text",placeholder:"请输入验证码","onUpdate:modelValue":a[2]||(a[2]=e=>x(s).code=e)},null,512),[[y,x(s).code]]),j(N,{num:x(s).num,w:60,h:30,onClick:o},null,8,["num"])]),v("button",{onClick:i},"登录"),v("button",{onClick:c},"注册")],2)]))}})),[["__scopeId","data-v-e2a11210"]]);export{T as default};
