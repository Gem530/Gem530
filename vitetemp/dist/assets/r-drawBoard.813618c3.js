var O=Object.defineProperty,I=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var F=(u,a,s)=>a in u?O(u,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[a]=s,p=(u,a)=>{for(var s in a||(a={}))V.call(a,s)&&F(u,s,a[s]);if(x)for(var s of x(a))H.call(a,s)&&F(u,s,a[s]);return u},_=(u,a)=>I(u,P(a));import{d as R,a as m,r as A,w as J,l as S,n as M,o as h,e as g,B as L,C as T,u as v,m as c,F as $,v as D,z as X,x as Y,y as j,f as q,J as G}from"./@vue.e9e6dad2.js";import{_ as K}from"./plugin-vue_export-helper.21dcd24c.js";const Q={class:"btn-base"},Z=["onClick"],ee={class:"btn-sub"},te=["onClick"],ae={name:"g-draw-board"},se=R(_(p({},ae),{props:{left:{type:Boolean,default:!1},width:{default:"100%"},height:{default:"200px"},colors:{default:()=>[{name:"\u7EA2",value:"#ff0000"},{name:"\u84DD",value:"#0000ff"},{name:"\u9EC4",value:"#ffff00"},{name:"\u7D2B",value:"#ff00ff"},{name:"\u7C89",value:"pink"}]},thickness:{default:()=>[{name:"\u7EC6",value:"1"},{name:"\u4E2D",value:"3"},{name:"\u7C97",value:"7"}]},background:{default:"#fff"},defaultColor:{default:"#000"},defaultThickness:{default:"2"}},emits:["upload"],setup(u,{expose:a,emit:s}){const i=u,d=m(),n=m(),r=m(),e=A({e:{pageX:"",pageY:""},flag:!0,color:"#000",width:"",height:"",subType:"",moveFlag:!1,thickness:"2",subBtnFlag:!1,baseList:[],btnsList:[{name:"\u989C\u8272",fun:()=>w("colors")},{name:"\u7C97\u7EC6",fun:()=>w("thickness")},{name:"\u6E05\u9664",fun:()=>k()},{name:"\u63D0\u4EA4",fun:()=>W()}]});J(()=>i,(t,o)=>{t.defaultColor&&(e.color=t.defaultColor),t.defaultThickness&&(e.thickness=t.defaultThickness)},{deep:!0,immediate:!0}),S(()=>{n.value=r.value.getContext("2d"),b(),window.addEventListener("mouseup",E),window.addEventListener("mousemove",y),window.addEventListener("mousedown",B),window.addEventListener("touchend",E),window.addEventListener("touchmove",y),window.addEventListener("touchstart",B)});const b=()=>{M(()=>{e.width=i.width==="100%"?d.value.clientWidth+"px":i.width,e.height=i.height==="100%"?d.value.clientHeight+"px":i.height,r.value.setAttribute("width",e.width),r.value.setAttribute("height",e.height),k()})},U=t=>e.subType==="colors"?`color: ${t.value};border-color: ${e.color===t.value?e.color:""}`:`border-color: ${e.thickness===t.value?e.color:""}`,w=t=>{e.subType!==t?e.subBtnFlag=!0:e.subBtnFlag=!e.subBtnFlag,e.subType=t,e.baseList=i[e.subType]},z=t=>{let o=e.subType==="colors"?"color":"thickness";e[o]=t,e.subBtnFlag=!1},k=()=>{n.value.fillStyle=i.background,n.value.fillRect(0,0,r.value.width,r.value.height)},W=()=>{n.value.drawImage(r.value,0,0,r.value.width,r.value.height);const t=r.value.toDataURL("image/png",1);r.value.toBlob(function(o){s("upload",t)},"image/png")},C=t=>{let o={pageX:0,pageY:0};if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)){const l=t;o={pageX:l.touches[0].pageX,pageY:l.touches[0].pageY}}else o={pageX:t.pageX,pageY:t.pageY};return o},B=t=>{e.moveFlag=!0,e.e=C(t)},y=t=>{if(!e.moveFlag||e.flag)return;const o=d.value.getBoundingClientRect().top,l=d.value.getBoundingClientRect().left,f=C(t);n.value.beginPath(),n.value.lineWidth=e.thickness,n.value.strokeStyle=e.color,n.value.moveTo(e.e.pageX-l,e.e.pageY-o),n.value.lineTo(f.pageX-l,f.pageY-o),n.value.stroke(),e.e=f},E=()=>{e.moveFlag=!1};return a({resizeChange:b}),(t,o)=>(h(),g("div",{class:"component theme",ref_key:"box",ref:d,style:Y(`width: ${i.width};height: ${i.height};`)},[L(c("div",{class:"mask theme",onClick:o[0]||(o[0]=l=>v(e).flag=!v(e).flag)},"\u70B9\u51FB\u7B7E\u7F72",512),[[T,v(e).flag]]),c("canvas",{ref_key:"myCanvas",ref:r},null,512),c("div",{class:j(["btn-box",i.left?"btn-box-lefts":""])},[c("div",Q,[(h(!0),g($,null,D(v(e).btnsList,(l,f)=>(h(),g("div",{class:"base-item",key:f,onClick:N=>l.fun()},X(l.name),9,Z))),128))]),L(c("div",ee,[(h(!0),g($,null,D(v(e).baseList,(l,f)=>(h(),g("div",{class:"base-item",key:f,style:Y(U(l)),onClick:N=>z(l.value)},X(l.name),13,te))),128))],512),[[T,v(e).subBtnFlag]])],2)],4))}}));var ne=K(se,[["__scopeId","data-v-0185f7f6"]]);const oe={class:"contanir theme"},le=G(" \u7B7E\u5B57\u677F "),ue=["src"],ie={name:"drawBoard"},fe=R(_(p({},ie),{setup(u){let a=m(null);const s=A({imageUrl:""});S(()=>{});const i=n=>{s.imageUrl=n},d=()=>{a.value.resizeChange()};return(n,r)=>(h(),g("div",oe,[le,q(ne,{ref_key:"drawBoardRef",ref:a,left:!1,width:"350px",height:"350px",background:"#fff","default-color":"pink","default-thickness":"2",colors:[{name:"\u9ED1",value:"#000"},{name:"\u7C89",value:"pink"}],thickness:[{name:"\u7EC6",value:"1"},{name:"\u7C97",value:"5"}],onUpload:i},null,512),c("div",null,[c("button",{onClick:d},"\u5C4F\u5E55\u53D8\u5316")]),c("img",{src:v(s).imageUrl,title:"\u7B7E\u5B57\u677F\u7ED3\u679C"},null,8,ue)]))}}));export{fe as default};
