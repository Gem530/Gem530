var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,o=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,i=(e,a)=>{for(var t in a||(a={}))n.call(a,t)&&o(e,t,a[t]);if(l)for(var t of l(a))s.call(a,t)&&o(e,t,a[t]);return e},u=(e,l)=>a(e,t(l));import{d as r,a as d,r as c,w as f,l as v,n as g,o as h,e as p,B as m,C as b,u as w,m as k,F as y,v as C,z as B,x,y as L,f as F,D as T}from"./@vue.fb42abb7.js";import{_ as O}from"./plugin-vue_export-helper.21dcd24c.js";const j={class:"btn-base"},P=["onClick"],X={class:"btn-sub"},Y=["onClick"];var E=O(r(u(i({},{name:"g-draw-board"}),{props:{left:{type:Boolean,default:!1},width:{default:"100%"},height:{default:"200px"},colors:{default:()=>[{name:"红",value:"#ff0000"},{name:"蓝",value:"#0000ff"},{name:"黄",value:"#ffff00"},{name:"紫",value:"#ff00ff"},{name:"粉",value:"pink"}]},thickness:{default:()=>[{name:"细",value:"1"},{name:"中",value:"3"},{name:"粗",value:"7"}]},background:{default:"#fff"},defaultColor:{default:"#000"},defaultThickness:{default:"2"}},emits:["upload"],setup(e,{expose:a,emit:t}){const l=e,n=d(),s=d(),o=d(),i=c({e:{pageX:"",pageY:""},flag:!0,color:"#000",width:"",height:"",subType:"",moveFlag:!1,thickness:"2",subBtnFlag:!1,baseList:[],btnsList:[{name:"颜色",fun:()=>F("colors")},{name:"粗细",fun:()=>F("thickness")},{name:"清除",fun:()=>T()},{name:"提交",fun:()=>O()}]});f((()=>l),((e,a)=>{e.defaultColor&&(i.color=e.defaultColor),e.defaultThickness&&(i.thickness=e.defaultThickness)}),{deep:!0,immediate:!0}),v((()=>{s.value=o.value.getContext("2d"),u(),window.addEventListener("mouseup",U),window.addEventListener("mousemove",R),window.addEventListener("mousedown",_),window.addEventListener("touchend",U),window.addEventListener("touchmove",R),window.addEventListener("touchstart",_)}));const u=()=>{g((()=>{i.width="100%"===l.width?n.value.clientWidth+"px":l.width,i.height="100%"===l.height?n.value.clientHeight+"px":l.height,o.value.setAttribute("width",i.width),o.value.setAttribute("height",i.height),T()}))},r=e=>"colors"===i.subType?`color: ${e.value};border-color: ${i.color===e.value?i.color:""}`:`border-color: ${i.thickness===e.value?i.color:""}`,F=e=>{i.subType!==e?i.subBtnFlag=!0:i.subBtnFlag=!i.subBtnFlag,i.subType=e,i.baseList=l[i.subType]},T=()=>{s.value.fillStyle=l.background,s.value.fillRect(0,0,o.value.width,o.value.height)},O=()=>{s.value.drawImage(o.value,0,0,o.value.width,o.value.height);const e=o.value.toDataURL("image/png",1);o.value.toBlob((function(a){t("upload",e)}),"image/png")},E=e=>{let a={pageX:0,pageY:0};if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)){const t=e;a={pageX:t.touches[0].pageX,pageY:t.touches[0].pageY}}else a={pageX:e.pageX,pageY:e.pageY};return a},_=e=>{i.moveFlag=!0,i.e=E(e)},R=e=>{if(!i.moveFlag||i.flag)return;const a=n.value.getBoundingClientRect().top,t=n.value.getBoundingClientRect().left,l=E(e);s.value.beginPath(),s.value.lineWidth=i.thickness,s.value.strokeStyle=i.color,s.value.moveTo(i.e.pageX-t,i.e.pageY-a),s.value.lineTo(l.pageX-t,l.pageY-a),s.value.stroke(),i.e=l},U=()=>{i.moveFlag=!1};return a({resizeChange:u}),(e,a)=>(h(),p("div",{class:"component theme",ref_key:"box",ref:n,style:x(`width: ${l.width};height: ${l.height};`)},[m(k("div",{class:"mask theme",onClick:a[0]||(a[0]=e=>w(i).flag=!w(i).flag)},"点击签署",512),[[b,w(i).flag]]),k("canvas",{ref_key:"myCanvas",ref:o},null,512),k("div",{class:L(["btn-box",l.left?"btn-box-lefts":""])},[k("div",j,[(h(!0),p(y,null,C(w(i).btnsList,((e,a)=>(h(),p("div",{class:"base-item",key:a,onClick:a=>e.fun()},B(e.name),9,P)))),128))]),m(k("div",X,[(h(!0),p(y,null,C(w(i).baseList,((e,a)=>(h(),p("div",{class:"base-item",key:a,style:x(r(e)),onClick:a=>(e=>{let a="colors"===i.subType?"color":"thickness";i[a]=e,i.subBtnFlag=!1})(e.value)},B(e.name),13,Y)))),128))],512),[[b,w(i).subBtnFlag]])],2)],4))}})),[["__scopeId","data-v-0185f7f6"]]);const _={class:"contanir theme"},R=T(" 签字板 "),U=["src"],$=r(u(i({},{name:"drawBoard"}),{setup(e){let a=d(null);const t=c({imageUrl:""});v((()=>{}));const l=e=>{t.imageUrl=e},n=()=>{a.value.resizeChange()};return(e,s)=>(h(),p("div",_,[R,F(E,{ref_key:"drawBoardRef",ref:a,left:!1,width:"350px",height:"350px",background:"#fff","default-color":"pink","default-thickness":"2",colors:[{name:"黑",value:"#000"},{name:"粉",value:"pink"}],thickness:[{name:"细",value:"1"},{name:"粗",value:"5"}],onUpload:l},null,512),k("div",null,[k("button",{onClick:n},"屏幕变化")]),k("img",{src:w(t).imageUrl,title:"签字板结果"},null,8,U)]))}}));export{$ as default};
