import{L as e,M as a,n as i}from"./element-plus.1a8f7ccb.js";import{g as l,d as s,_ as d}from"./index.f5ed39b5.js";import{k as o,K as t,d as n,$ as u,e as r,o as p,c as f,W as c,a9 as m,u as v,U as h,I as g,a as w,Y as x,J as y,T as V,Q as _,g as z}from"./@vue.df4a0536.js";const T={class:"g-upload"},$={class:"el-upload__tip"},j=d(o({__name:"index",props:{data:{default:()=>({fileTo:""})},action:{default:"/prod-api/upload/img"},fileSize:{default:5},fileType:{default:()=>["png","jpg","gif","jpeg"]},isHideTip:{type:Boolean,default:!1},modelValue:{default:()=>[]},isHideDelete:{type:Boolean,default:!1},isHidePreview:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:o}){const j=d,H=t(),B=n([]),{proxy:S}=z(),k=n({Authorization:l("token")}),I=u({index:5,showView:!1});j.modelValue&&j.modelValue.length>0&&j.modelValue.forEach(((e,a)=>{const i={uid:a,url:e};B.value.push(i)})),r((()=>B.value),(e=>{o("update:modelValue",e)}),{deep:!0,immediate:!0});const P=e=>{const a=e.name.slice(e.name.lastIndexOf(".")+1);if(!j.fileType.includes(a))return i.error(`文件格式不正确, 请上传${j.fileType.join("/")}图片格式文件!`),!1;if(!(e.size/1024/1024<j.fileSize))return i.error(`上传图片大小不能超过 ${j.fileSize} MB!`),!1;S.$modal.loading("图片上传中...")},b=()=>{S.$modal.closeLoading(),i.error("图片上传失败")},L=()=>{S.$modal.closeLoading(),i.success("图片上传成功")},M=e=>{const a=B.value.findIndex((a=>a.uid===e.uid));I.index=a<=0?0:a,I.showView=!0},D=()=>{I.showView=!1};return(i,l)=>{var d,o;const t=s,n=e,u=a;return p(),f("div",T,[c(n,y(v(H),{data:j.data,headers:k.value,action:j.action,"list-type":"picture-card","file-list":B.value,"onUpdate:file-list":l[0]||(l[0]=e=>B.value=e),"before-upload":P,class:{"hide-delete":j.isHideDelete,"hide-preview":j.isHidePreview,hide:B.value.length>=(null==(d=v(H))?void 0:d.limit)},onError:b,onSuccess:L,onPreview:M}),m({default:h((()=>[c(t,{icon:"Plus",size:30})])),_:2},[!j.isHideTip&&B.value.length<(null==(o=v(H))?void 0:o.limit)?{name:"tip",fn:h((()=>[g(i.$slots,"tip",{},(()=>[w("div",$,"图片不能超过 "+x(j.fileSize)+"MB",1)]),!0)])),key:"0"}:void 0]),1040,["data","headers","action","file-list","class"]),I.showView?(p(),V(u,{key:0,"initial-index":I.index,"url-list":B.value.map((e=>e.url)),onClose:D},null,8,["initial-index","url-list"])):_("",!0)])}}}),[["__scopeId","data-v-0309daa8"]]);export{j as _};
