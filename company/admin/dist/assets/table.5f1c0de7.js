import{b as e}from"./base.cc75b0f9.js";import"./axios.68af02ab.js";import"./index.f5ed39b5.js";import{d as a,$ as l,g as t}from"./@vue.df4a0536.js";function d(){const d=a({tableUrl:"",tableMethod:"get",getUrl:"",getMethod:"get",addUrl:"",addMethod:"post",editUrl:"",editMethod:"put",delUrl:"",delMethod:"delete",delMultiplepUrl:"",delMultiplepMethod:"delete",dataStr:"data"}),{proxy:o}=t(),u=()=>o.$modal.loading(),i=()=>o.$modal.closeLoading(),r=e=>o.$modal.confirm(e),s=e=>o.$modal.message({type:"error",message:e}),n=e=>o.$modal.message({type:"success",message:e}),p=a(),v=a(),g=()=>{p.value.searchHandle()},c=a(),h=a(),m=a({}),M=l({total:0,pageSize:10,pageIndex:1,dataSource:[]}),b=()=>{const e={url:d.value.tableUrl,method:d.value.tableMethod},a={...m.value,pageSize:M.pageSize,pageIndex:M.pageIndex};"get"===d.value.tableMethod?e.params=a:e.data=a,x(e,"",!1,(e=>{h.value&&h.value(e.data.rows),M.dataSource=e.data[d.value.dataStr]||[],M.total=e.data.total||0}))},f=a(),U=a(),D=a("add"),S=a(!1),$=e=>{const a="add"===D.value?d.value.addUrl:d.value.editUrl,l="add"===D.value?d.value.addMethod:d.value.editMethod,t={url:a,method:l};"get"===l?t.params=e:t.data=e,x(t,("add"===D.value?"新增":"编辑")+"成功",!0,(()=>{S.value=!1}))},x=(a,l,t,d)=>{u(),e(a).then((e=>{200===e.code?(l&&n(l),t&&b(),d&&d(e)):s(e.msg)})).catch((e=>{s(e.message)})).finally((()=>{i()}))};return{baseData:d,GFormRef:p,tableRef:c,formData:m,dealTable:h,tableData:M,dealSearch:v,dealDialog:f,typeDialog:D,showDialog:S,modalFormRef:U,search:e=>{m.value=v.value?v.value(e):e,M.pageIndex=1,b()},getList:b,errorTip:s,initTable:e=>{d.value=Object.assign(d.value,e),b()},succesTip:n,apiHandle:x,delHandle:(e,a="id为")=>{r(`确定删除${a}${e}的数据吗?`).then((()=>{const a={url:d.value.delUrl+e,method:d.value.delMethod};x(a,"删除成功",!0)})).catch((()=>{}))},loadingTip:u,confirmTip:r,changeSearch:g,addDialogOpen:(e="新增")=>{U.value.initModalData("",e),S.value=!0,D.value="add"},confirmDialog:e=>{const a=f.value?f.value(e):e;$(a)},editDialogOpen:(e,a="编辑")=>{const l={url:d.value.getUrl+e,method:d.value.getMethod};x(l,"",!1,(e=>{U.value.initModalData(e.data,a),S.value=!0,D.value="edit"}))},addOrEditHandle:$,clossLoadingTip:i,keyUpEnterSearch:e=>{13===e.keyCode&&g()},delMultiplepHandle:(e,a="")=>{(null==e?void 0:e.length)?r(`确定删除${a}${e}的数据吗?`).then((()=>{d.value.delMultiplepUrl,d.value.delMultiplepMethod})).catch((()=>{})):s("请选择需要删除的数据")}}}export{d as t};
